from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
import smtplib
import sqlite3

product_name = ['windows_server_2012','windows_server_2016','windows_7','windows_10']
product_name_str = ' '.join(product_name)


department_dict = {'devs':'oag.bvg.devs@mailinator.com',
                   'windows':'windows.oag@mailinator.com',
                   'linux_ent':'enterprise_linux.oag@mailinator.com',}

def email_block(product):

    # smtplib start - From, From password, To, Subject & Body
    msg = MIMEMultipart()
    msg['From'] = 'oag.bvg.test@gmail.com'
    password = '240Sparks'
    msg['To'] = 'oag.windows@mailinator.com'
    msg['Subject'] = 'Email subject line'
    body = 'This will be the body of the email' \
           '<br>' \
           'Even HTML works' \
           '<br>' \
           'Hello world'\
           '<br>'\
           'Vuln test : ' + product_name_str\

    msg.attach(MIMEText(body, 'html'))
    print(msg)

    # SMTP server and port number. Not to be omitted.
    server = smtplib.SMTP_SSL("smtp.gmail.com", 465)
    server.login(msg['From'], password)
    server.sendmail(msg['From'], msg['To'], msg.as_string())
    server.quit()

for product in product_name:
    email_block(product)
